{
  "$schema": "https://playground.wordpress.net/blueprint-schema.json",
  "constants": {
    "WP_DEBUG": true
  },
  "steps": [
    {
      "step": "resetData"
    },
    {
      "step": "writeFile",
      "path": "/wordpress/wp-content/mu-plugins/rewrite.php",
      "data": "<?php /* Use pretty permalinks */ add_action( 'after_setup_theme', function() { global $wp_rewrite; $wp_rewrite->set_permalink_structure('/%postname%/'); $wp_rewrite->flush_rules(); } );"
    },
    {
      "step": "installPlugin",
      "pluginData": {
        "resource": "wordpress.org/plugins",
        "slug": "woocommerce"
      },
      "options": {
        "activate": true
      }
    },
    {
      "step": "setSiteOptions",
      "options": {
        "show_on_front": "page",
        "woocommerce_onboarding_profile": {
          "skipped": true
        },
        "woocommerce_default_country": "SE",
        "woocommerce_currency": "SEK",
        "woocommerce_price_num_decimals": "2"
      }
    },
    {
      "step": "wp-cli",
      "command": "wp transient delete _wc_activation_redirect"
    },
    {
      "step": "wp-cli",
      "command": "wp wc product create --name='Simple product' --sku='simple-product' --regular_price='99.99' --virtual=false --downloadable=false --user='admin'"
    },
    {
      "step": "runPHP",
      "code": "<?php require_once 'wordpress/wp-load.php'; $page = get_page_by_path('refund_returns'); if ($page) { wp_publish_post($page->ID); update_option('woocommerce_terms_page_id', $page->ID); }"
    },
    {
      "step": "runPHP",
      "code": "<?php require_once 'wordpress/wp-load.php'; $shop_page_id = get_option('woocommerce_shop_page_id'); if ($shop_page_id) { update_option('page_on_front', $shop_page_id); update_option('show_on_front', 'page'); }"
    },
    {
      "step": "runPHP",
      "code": "<?php require_once 'wordpress/wp-load.php'; $checkout_page_id = get_option('woocommerce_checkout_page_id'); if ($checkout_page_id) { wp_update_post(['ID' => $checkout_page_id, 'post_content' => '[woocommerce_checkout]']); }"
    },
    {
      "step": "activatePlugin",
      "pluginPath": "/wordpress/wp-content/plugins/klarna-checkout-for-woocommerce/klarna-checkout-for-woocommerce.php"
    }
  ],
  "login": true,
  "landingPage": "/wp-admin/admin.php?page=wc-settings&tab=checkout&section=kco&from=WCADMIN_PAYMENT_SETTINGS"
}